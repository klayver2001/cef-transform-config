<% // backend/src/templates/huawei-v2r10-com_switch-tipo1.ejs %>
#
# OWNER OI -- HUAWEI (V2R10) COM SWITCH
# TIPO1_<%= codigoUl %>
#
clock timezone BRZ minus 03:00:00
#
sysname <%= codigoUl %>_RT02
#
header shell information "
**************************************************************************************
*                                  Alerta                                            *
*                                                                                    *
*         O acesso a este sistema eh limitado a usuarios autorizados.                *
* Todas as informacoes e comunicacoes sobre este sistema sao monitoradas e gravadas. *
*                                                                                    *
*          O Acesso sem autorizado estah sujeito as medidas legais.                  *
*                                                                                    *
**************************************************************************************
"
header login information "
RTHU**********************************************************************************
*                                                                                    *
*                             ########################                               *
*                             ########################                               *
*                             ####                                                   *
*                             ####                                                   *
*                             ####                                                   *
*                                                 ####                               *
*                                                 ####                               *
*                                                 ####                               *
*                             ########################                               *
*                             ########################                               *
*                                                                                    *
*                                      Alerta                                        *
*                                                                                    *
*           O acesso a este sistema e limitado a usuarios autorizados.               *
* Todas as informacoes e comunicacoes sobre este sistema sao monitoradas e gravadas. *
*            O Acesso sem autorizado esta sujeito as medidas legais.                 *
*                                                                                    *
**************************************************************************************
"
#
drop illegal-mac alarm
#
multicast routing-enable
#
acl number 2950
rule 0 permit source 172.31.249.0 0.0.0.255
rule 5 permit source 172.31.253.0 0.0.0.255
rule 8 permit source 200.218.181.0 0.0.0.255
rule 10 deny logging
#
acl number 3010
rule 0 permit udp source-port eq snmp precedence routine
rule 5 permit udp destination-port eq snmp precedence routine
rule 10 permit udp source-port eq snmptrap precedence routine
rule 15 permit udp destination-port eq snmptrap precedence routine
rule 20 permit tcp source-port eq tacacs
rule 25 permit tcp destination-port eq tacacs
rule 30 permit tcp source-port eq telnet
rule 35 permit tcp destination-port eq telnet
rule 40 permit udp source-port eq tftp
rule 45 permit udp destination-port eq tftp
rule 50 permit tcp source-port eq 22
rule 55 permit tcp destination-port eq 22
rule 60 permit udp source-port eq ntp
rule 65 permit udp destination-port eq ntp
rule 70 permit udp source-port eq 1967
rule 75 permit udp destination-port eq 1967
acl number 3020
rule 0 permit ip dscp af33
rule 5 permit tcp destination-port eq bgp
rule 10 permit tcp source-port eq bgp
acl number 3102
rule 0 permit tcp source 99.244.0.0 0.3.255.255 destination 172.16.32.67 0 destination-port eq 443
rule 5 permit tcp source 172.16.32.67 0 source-port eq 443 destination 99.244.0.0 0.3.255.255
rule 10 permit tcp source 99.244.0.0 0.3.255.255 destination 172.16.32.67 0 destination-port eq 1443
rule 15 permit tcp source 172.16.32.67 0 source-port eq 1443 destination 99.244.0.0 0.3.255.255
rule 20 permit tcp source 99.244.0.0 0.3.255.255 destination 172.17.32.67 0 destination-port eq 443
rule 25 permit tcp source 172.17.32.67 0 source-port eq 443 destination 99.244.0.0 0.3.255.255
rule 30 permit tcp source 99.244.0.0 0.3.255.255 destination 172.17.32.67 0 destination-port eq 1443
rule 35 permit tcp source 172.17.32.67 0 source-port eq 1443 destination 99.244.0.0 0.3.255.255
rule 40 permit udp source 99.244.0.0 0.3.255.255 destination 172.16.32.68 0 destination-port eq dns
rule 45 permit udp source 172.16.32.68 0 source-port eq dns destination 99.244.0.0 0.3.255.255
rule 50 permit udp source 99.244.0.0 0.3.255.255 destination 172.16.32.69 0 destination-port eq dns
rule 55 permit udp source 172.16.32.69 0 source-port eq dns destination 99.244.0.0 0.3.255.255
rule 60 permit udp source 99.244.0.0 0.3.255.255 destination 172.17.32.68 0 destination-port eq dns
rule 65 permit udp source 172.17.32.68 0 source-port eq dns destination 99.244.0.0 0.3.255.255
rule 70 permit ip dscp af31
rule 75 deny ip
acl number 3103
rule 0 permit udp source 99.244.0.0 0.3.255.255 destination 172.16.32.68 0 destination-port eq ntp dscp default
rule 5 permit udp source 172.16.32.68 0 source-port eq ntp destination 99.244.0.0 0.3.255.255
rule 10 permit udp source 99.244.0.0 0.3.255.255 destination 172.16.32.69 0 destination-port eq ntp
rule 15 permit udp source 172.16.32.69 0 source-port eq ntp destination 99.244.0.0 0.3.255.255
rule 20 permit udp source 99.244.0.0 0.3.255.255 destination 172.17.32.68 0 destination-port eq ntp
rule 25 permit udp source 172.17.32.68 0 source-port eq ntp destination 99.244.0.0 0.3.255.255
rule 30 permit udp source 99.244.0.0 0.3.255.255 destination 172.17.32.69 0 destination-port eq ntp
rule 35 permit udp source 172.17.32.69 0 source-port eq ntp destination 99.244.0.0 0.3.255.255
rule 40 permit tcp source 99.244.0.0 0.3.255.255 destination 172.16.32.50 0 destination-port eq www
rule 45 permit tcp source 172.16.32.50 0 source-port eq www destination 99.244.0.0 0.3.255.255
rule 50 permit tcp source 99.244.0.0 0.3.255.255 destination 172.16.32.50 0 destination-port eq 443
rule 55 permit tcp source 172.16.32.50 0 source-port eq 443 destination 99.244.0.0 0.3.255.255
rule 60 permit tcp source 99.244.0.0 0.3.255.255 destination 172.17.32.50 0 destination-port eq www
rule 65 permit tcp source 172.17.32.50 0 source-port eq www destination 99.244.0.0 0.3.255.255
rule 70 permit tcp source 99.244.0.0 0.3.255.255 destination 172.17.32.50 0 destination-port eq 443
rule 75 permit tcp source 172.17.32.50 0 source-port eq 443 destination 99.244.0.0 0.3.255.255
rule 80 permit icmp source 99.244.0.0 0.3.255.255 destination 172.16.32.68 0
rule 85 permit icmp source 172.16.32.68 0 destination 99.244.0.0 0.3.255.255
rule 90 permit icmp source 99.244.0.0 0.3.255.255 destination 172.16.32.69 0
rule 95 permit icmp source 172.16.32.69 0 destination 99.244.0.0 0.3.255.255
rule 100 permit tcp source 99.244.0.0 0.3.255.255 destination 172.17.220.37 0 destination-port eq www
rule 105 permit tcp source 172.16.220.37 0 source-port eq www destination 99.244.0.0 0.3.255.255
rule 110 permit tcp source 99.244.0.0 0.3.255.255 destination 172.17.220.41 0 destination-port eq www
rule 115 permit tcp source 172.16.220.41 0 source-port eq www destination 99.244.0.0 0.3.255.255
rule 120 permit icmp source 99.244.0.0 0.3.255.255 destination 172.16.220.38 0
rule 125 permit icmp source 172.16.220.38 0 destination 99.244.0.0 0.3.255.255
rule 130 permit icmp source 99.244.0.0 0.3.255.255 destination 172.16.220.39 0
rule 135 permit icmp source 172.16.220.39 0 destination 99.244.0.0 0.3.255.255
rule 140 permit icmp source 99.244.0.0 0.3.255.255 destination 172.16.220.40 0
rule 145 permit icmp source 172.16.220.40 0 destination 99.244.0.0 0.3.255.255
rule 150 permit udp source 99.244.0.0 0.3.255.255 destination 172.16.220.38 0 destination-port eq discard
rule 155 permit udp source 172.16.220.38 0 source-port eq discard destination 99.244.0.0 0.3.255.255
rule 160 permit udp source 99.244.0.0 0.3.255.255 destination 172.16.220.39 0 destination-port eq echo
rule 165 permit udp source 172.16.220.39 0 source-port eq echo destination 99.244.0.0 0.3.255.255
rule 170 permit udp source 99.244.0.0 0.3.255.255 destination 172.16.220.40 0 destination-port eq echo
rule 175 permit udp source 172.16.220.40 0 source-port eq echo destination 99.244.0.0 0.3.255.255
rule 180 permit tcp source 99.244.0.0 0.3.255.255 destination 172.16.220.38 0 destination-port eq 22
rule 185 permit tcp source 172.16.220.38 0 source-port eq 22 destination 99.244.0.0 0.3.255.255
rule 190 permit tcp source 99.244.0.0 0.3.255.255 destination 172.16.220.39 0 destination-port eq 22
rule 195 permit tcp source 172.16.220.39 0 source-port eq 22 destination 99.244.0.0 0.3.255.255
rule 200 permit tcp source 99.244.0.0 0.3.255.255 destination 172.16.220.40 0 destination-port eq 22
rule 205 permit tcp source 172.16.220.40 0 source-port eq 22 destination 99.244.0.0 0.3.255.255
rule 210 permit tcp source 99.244.0.0 0.3.255.255 destination 172.24.45.250 0 destination-port eq www
rule 215 permit tcp source 172.24.45.250 0 source-port eq www destination 99.244.0.0 0.3.255.255
rule 220 permit tcp source 99.244.0.0 0.3.255.255 destination 172.24.45.250 0 destination-port eq 3306
rule 225 permit tcp source 172.24.45.250 0 source-port eq 3306 destination 99.244.0.0 0.3.255.255
rule 230 permit tcp source 99.244.0.0 0.3.255.255 destination 172.16.32.92 0 destination-port eq 1952
rule 235 permit tcp source 172.16.32.92 0 source-port eq 1952 destination 99.244.0.0 0.3.255.255
rule 240 permit tcp source 99.244.0.0 0.3.255.255 destination 172.24.45.246 0 destination-port eq 22
rule 245 permit tcp source 172.24.45.246 0 source-port eq 22 destination 99.244.0.0 0.3.255.255
rule 250 permit icmp source 99.244.0.0 0.3.255.255 destination 172.17.150.16 0.0.0.15
rule 255 permit icmp source 172.17.150.16 0.0.0.15 destination 99.244.0.0 0.3.255.255
rule 260 permit icmp source 10.48.0.0 0.3.255.255 destination 172.17.150.16 0.0.0.15
rule 265 permit icmp source 172.17.150.16 0.0.0.15 destination 10.48.0.0 0.3.255.255
rule 270 permit ip source 172.31.248.0 0.0.7.255
rule 275 permit ip destination 172.31.248.0 0.0.7.255
rule 280 permit ip source 99.244.0.0 0.3.255.255 destination 172.30.4.176 0.0.0.15
rule 285 permit ip source 172.30.4.176 0.0.0.15 destination 99.244.0.0 0.3.255.255
rule 290 permit ip source 99.244.0.0 0.3.255.255 destination 10.48.0.0 0.3.255.255
rule 295 permit ip source 10.48.0.0 0.3.255.255 destination 99.244.0.0 0.3.255.255
rule 300 permit ip source 172.19.217.0 0.0.0.255
rule 305 permit ip destination 172.19.217.0 0.0.0.255
rule 310 permit ip source 172.19.214.0 0.0.0.15
rule 315 permit ip destination 172.19.214.0 0.0.0.15
rule 320 permit ip source 172.19.215.0 0.0.0.7
rule 325 permit ip destination 172.19.215.0 0.0.0.7
rule 330 permit ip source 172.19.26.48 0.0.0.7
rule 335 permit ip destination 172.19.26.48 0.0.0.7
rule 340 permit ip dscp af21
rule 345 deny ip
acl number 3104
rule 0 permit ip dscp default
rule 5 permit ip
#
traffic classifier class-default_in operator or
if-match dscp default
traffic classifier class-default operator or
if-match acl 3104
traffic classifier sup_in operator or
if-match dscp af33
traffic classifier priority_in operator or
if-match dscp af12 cs2 af21
traffic classifier priority operator or
if-match acl 3103
traffic classifier sup operator or
if-match acl 3020
traffic classifier critical_in operator or
if-match dscp af13 cs3 af31
traffic classifier critical operator or
if-match acl 3102
#
traffic behavior class-default
queue af bandwidth pct 20
wred dscp
wred dscp default low-limit 8 high-limit 24 discard-probability 1
remark dscp default
traffic behavior priority
queue af bandwidth pct 25
wred dscp
wred dscp af21 low-limit 595 high-limit 600 discard-probability 1
remark dscp af21
traffic behavior traffic_in
traffic behavior sup
queue af bandwidth pct 5
remark dscp af33
traffic behavior critical
queue af bandwidth pct 50
remark dscp af31
#
qos policy CE_DC_IN
classifier sup_in behavior traffic_in
classifier critical_in behavior traffic_in
classifier priority_in behavior traffic_in
classifier class-default_in behavior traffic_in
qos policy DC_50-25-25_512K
classifier sup behavior sup
classifier critical behavior critical
classifier priority behavior priority
classifier class-default behavior class-default
#
policy-based-route 10 permit node 10
if-match acl 3010
apply ip-precedence flash
policy-based-route 10 permit node 20
if-match acl 3020
apply ip-precedence flash
#
dhcp server group group1
dhcp-server 172.31.248.215 1
dhcp-server 172.31.252.215 2
#
pim
auto-rp listening enable
static-rp 172.17.150.33
#
domain default_admin
#
interface Ethernet0/0/4
description connected to Brisanet
ip address <%= ipWanBkp2 %> 255.255.255.252
pim sm
igmp enable
igmp static-group 230.1.1.2
trust dscp
#
interface Ethernet0/0/1
port link-type access
#
interface Ethernet0/0/3
port link-type access
#
interface Ethernet0/0/2
undo portswitch
description Switch Eth0/14
ip address <%= ipRedeVlan3 %> 255.255.255.240
ip address <%= ipSwitchRouter %> 255.255.255.248 sub
vrrp vrid 1 virtual-ip <%= ipRedeVlan1 %>
vrrp vrid 2 virtual-ip <%= ipSwitchVip %>
dhcp select relay
dhcp relay server-select group1
pim sm
igmp enable
igmp static-group 230.1.1.2
trust dscp
#
interface LoopBack10
description gerenciamento CEF circuito NNI secundário
ip address <%= ipLoopback10 %> 255.255.255.255
#
route-policy LAN_TFL_LOOPBACK10 permit node 10
if-match ip-prefix LAN_TFL_LOOPBACK10
#
route-policy ROTAS_DC permit node 10
if-match ip-prefix ROTAS_DC
#
route-policy LAN_TFL permit node 10
if-match ip-prefix LAN_TFL
#
ip ip-prefix LAN_TFL_LOOPBACK10 index 10 permit 10.50.128.0 16 less-equal 32
ip ip-prefix LAN_TFL_LOOPBACK10 index 20 deny 0.0.0.0 0 less-equal 32
ip ip-prefix LAN_TFL_LOOPBACK10 index 15 permit 99.244.0.0 14 greater-equal 14 less-equal 28
#
ip ip-prefix LAN_TFL index 10 permit 99.244.0.0 14 less-equal 28
ip ip-prefix LAN_TFL index 70 deny 0.0.0.0 0 less-equal 32
ip ip-prefix ROTAS_DC index 10 permit 172.16.0.0 16 less-equal 32
ip ip-prefix ROTAS_DC index 20 permit 172.17.0.0 16 less-equal 32
ip ip-prefix ROTAS_DC index 30 permit 172.18.0.0 16 less-equal 32
ip ip-prefix ROTAS_DC index 40 permit 172.24.0.0 16 less-equal 32
ip ip-prefix ROTAS_DC index 50 permit 172.27.0.0 16 less-equal 32
ip ip-prefix ROTAS_DC index 60 permit 172.31.0.0 16 less-equal 32
ip ip-prefix ROTAS_DC index 70 permit 200.218.181.0 24 less-equal 32
ip ip-prefix ROTAS_DC index 80 permit 10.51.127.255 32
ip ip-prefix ADV_BRISANET index 10 permit 99.244.0.0 14 less-equal 28
ip ip-prefix ADV_BRISANET index 20 permit 10.50.0.0 16 less-equal 32
ip ip-prefix ADV_BRISANET index 30 deny 0.0.0.0 0 less-equal 32
#
ip route-static 0.0.0.0 0.0.0.0 <%= ipWanBkp1 %>
#
bgp 64765
router-id <%= ipLoopback10 %>
timer keepalive 10 hold 30
peer 192.168.248.253 as-number 65002
peer <%= ipWanBkp1 %> as-number 64999
network <%= ipLoopback10 %> 255.255.255.255
network <%= ipRedeVlan %> 255.255.255.240
#
ipv4-family unicast
undo synchronization
peer 192.168.248.253 enable
peer <%= ipWanBkp1 %> route-policy LAN_TFL_LOOPBACK10 export
peer <%= ipWanBkp1 %> ip-prefix ADV_BRISANET export
peer 192.168.248.253 route-policy ROTAS_DC export
peer 192.168.248.253 ip-prefix LAN_TFL import
#
snmp-agent
snmp-agent sys-info contact Sencinet
snmp-agent sys-info version v3
snmp-agent group v3 GRP_LOTERICOS authentication acl 2950
snmp-agent group v3 GRP_LOTERICOS privacy write-view lotericos acl 2950
snmp-agent group v3 GRP_LOTERICOS authentication write-view lotericos acl 2950
snmp-agent usm-user v3 lotericos
snmp-agent group v3 GRP_LOTERICOS privacy write-view mib-lotericos
snmp-agent mib-view mib-lotericos include iso
snmp-agent usm-user v3 lotericos group GRP_LOTERICOS
snmp-agent usm-user v3 lotericos authentication-mode sha
Consorcio12#
Consorcio12#
#
snmp-agent usm-user v3 lotericos privacy-mode des56
12#Consorcio
12#Consorcio
snmp-agent usm-user v3 lotericos acl 2950
#
ip route-static 172.31.248.45 255.255.255.255 <%= ipWanBkp1 %>
ip route-static 172.31.252.45 255.255.255.255 <%= ipWanBkp1 %>
#
nqa test-instance icmp loopback10
test-type icmp
destination-address ipv4 10.98.0.1
frequency 300
probe-count 15
source-interface LoopBack 10
start now
#
user-interface con 0
authentication-mode aaa
#
info-center enable
info-center source default channel 2 trap level informational
info-center loghost source LoopBack10
info-center loghost 172.31.249.36 transport udp port 20008
info-center loghost 172.31.253.36 transport udp port 20008
info-center timestamp log format-date
#
ntp-service source-interface LoopBack10
ntp-service unicast-peer 172.31.248.66 preference
ntp-service unicast-peer 172.31.252.66
ntp-service unicast-peer 172.31.248.215
ntp-service unicast-peer 172.31.252.215
tftp client-source -i loopback10
#
telnet server ena
stelnet server ena
hwtacacs-server template fac-tacacs-template
hwtacacs-server authentication 172.31.248.45
hwtacacs-server authorization 172.31.252.45 secondary
hwtacacs-server accounting 172.31.248.45
hwtacacs-server authentication 172.31.252.45 secondary
hwtacacs-server authorization 172.31.248.45
hwtacacs-server accounting 172.31.252.45 secondary
hwtacacs-server source-ip <%= ipLoopback10 %>
hwtacacs-server shared-key cipher Consorcio123@
quit
#
undo aaa
Y
#
aaa
authentication-scheme fac-tacacs-scheme
authentication-mode hwtacacs local
authorization-scheme fac-tacacs-scheme
authorization-mode hwtacacs local
accounting-scheme fac-tacacs-scheme
accounting interim-fail offline
domain default_admin
authentication-scheme fac-tacacs-scheme
accounting-scheme fac-tacacs-scheme
authorization-scheme fac-tacacs-scheme
hwtacacs-server fac-tacacs-template
local-user sysop_oi password irreversible-cipher $1a$QX>i0IkQ%=$o{oV$QAb"U3EzL/'jb4P4\coU@uCMK(B3R>2QrK5$
local-user sysop_oi privilege level 1
y
local-user sysop_oi service-type terminal ssh
local-user sysop password cipher PDOc8N93!XNtREFx$
local-user sysop privilege level 15
y
local-user sysop service-type terminal ssh telnet
#
quit
#
domain default_admin
#
user-interface vty 0 4
authentication-mode aaa
protocol in ssh
quit
#
save
Y